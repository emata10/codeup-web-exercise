<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<script src="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.js"></script>
	<link href="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.css" rel="stylesheet" />
	
	
	<title>Weather App</title>
	
	<!--css style-->
	
	<style>
		body {
			font-family: Arial, sans-serif;
			background-color: #f2f2f2;
		}
		
		h1 {
			text-align: center;
		}
		
		.weather {
			width: 400px;
			margin: 0 auto;
			background-color: #fff;
			padding: 20px;
			border-radius: 5px;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
		}
		
		.weather-info {
			display: flex;
			justify-content: space-between;
			margin-bottom: 10px;
		}
		
		.weather-info span {
			font-weight: bold;
		}
		
		.weather-info img {
			width: 50px;
			height: 50px;
		}
		.card-header {
			background-color: #3498db;
			color: white;
			font-size: 24px;
			font-weight: bold;
		}
		.card-body {
			background-color: #f1f1f1;
		}
		
		#map {
			height: 300px;
			width: 100%
		}
	</style>
</head>
<body>
<div id="weather" class="weather-info"></div>
<div id="weatherResultSection"></div>
<div id="map"></div>
<div class="top-banner">
	<div class="container">
		<h1 class="heading">Weather App</h1>
		<form id="weatherForm">
			<label>
				<input type="text"  id="locationInput"  placeholder="City, State, Zip Code" autofocus>
			</label>
			<button type="submit" id="submitBtn">Find</button>
			<span class="msg"></span>
		</form>
	</div>
</div>

<script src="js/mapbox-geocoder-utils.js"></script>
<script src="js/keys.js"></script>
<script>
		
		"use script";
		$(document).ready(function () {
			mapboxgl.accessToken = 'YOUR_MAPBOX_ACCESS_TOKEN';
			const map = new mapboxgl.Map({
				container: 'map',
				style: 'mapbox://styles/mapbox/streets-v11',
				center: [-106.486040, 31.768980],
				zoom: 6,
			});
			const marker = new mapboxgl.Marker();
			
			$("#weatherForm").submit(function (event) {
				event.preventDefault();
				let location = $("#locationInput").val();
				if (location !== '') {
					geocode(location, function (coordinates) {
						map.flyTo({ center: coordinates, zoom: 10 });
						marker.setLngLat(coordinates).addTo(map);
						updateForecast(coordinates);
					});
						}
					});
			function geocode(location, callback) {
				const geocoder = new MapboxGeocoder({
					accessToken: mapboxgl.accessToken,
					mapboxgl: mapboxgl
				});
				
				geocoder.query(location, function (results) {
					if (results && results.features && results.features.length > 0) {
						const coordinates = results.features[0].center;
						callback(coordinates);
					}
				});
			}
			
			
			function updateForecast(coordinates) {
				let city = $("cityInput").val();
				
				if (city !== '') {
					$.ajax({
						url: 'https://api.openweathermap.org/data/2.5/forecast?q=' + city + '&units=metric&appid=' + weatherMapKey,
						type: 'GET',
						dataType: 'json',
						success: function (data) {
							let weatherResultSection = $("#weatherResultSection");
							weatherResultSection.empty();
							for (let i = 0; i < 5; i++) {
								
								let cardBody = $('<div class="card-body" style="min-height: 150px;"></div>');
								let weatherParagraph = $('<p class="card-text">Weather: ' + weather + '</p>');
								// Append elements within for loop
								cardHeader.append(dayName);
								cardBody.append('<p>Temp: ' + temp + ' &#8451;</p>');
								cardBody.append('<p>Humidity: ' + humidity + '%</p>');
								cardBody.append(weatherParagraph);
								card.append(cardHeader);
								card.append(cardBody);
								weatherResultSection.append(card);
							}
						},
						error: function (error) {
							console.log(error);
						}
					});
				}
			}
		});
							
							
							mapboxgl.accessToken = 'myMapBoxKey';
							let map = new mapboxgl.Map({
								container: 'map',
								style: 'mapbox://styles/mapbox/streets-v11',
								center: [-106.486040, 31.768980],
								zoom: 6,
							});
							
							map.on('click', function (e) {
								let coordinates = e.lngLat;
								// Place a pin on the map
								new mapboxgl.Marker().setLngLat(coordinates).addTo(map);
								
								// Call the OpenWeatherMap API with the coordinates
								// and update the forecast accordingly
								updateForecast(coordinates);
							});
		function updateForecast(coordinates) {
			// Add code to call the OpenWeatherMap API here
			// and update the forecast based on the coordinates given.
		}
		
	
		
</script>
</body>
</html>
